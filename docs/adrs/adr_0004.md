---
title: "Event Bus for Cross-Component Communication"
description: "Central event bus using tokio broadcast channels for loose coupling between components, enabling async state change notifications."
type: adr
category: architecture
tags:
  - event-bus
  - async
  - decoupling
  - broadcast
  - state-management
status: published
created: 2025-12-28
updated: 2026-01-04
author: Claude (Architect)
project: subcog
technologies:
  - tokio
  - broadcast-channels
audience:
  - developers
  - architects
confidence: high
completeness: complete
---

# ADR-0004: Event Bus for Cross-Component Communication

## Status

Accepted

## Context

Features need to communicate state changes:

- Capture should trigger index updates
- Search should notify metrics
- Consolidation should update tiers

Direct coupling between components creates tight dependencies.

## Decision

We will implement a central event bus using tokio broadcast channels:

```rust
pub enum MemoryEvent {
    MemoryCaptured { /* ... */ },
    SearchCompleted { /* ... */ },
    SyncCompleted { /* ... */ },
    // ...
}

pub struct EventBus {
    sender: broadcast::Sender<MemoryEvent>,
}
```

Components subscribe to events they care about and react asynchronously.

## Consequences

### Positive

- Loose coupling between components
- Easy addition of new handlers
- Centralized event logging
- Testable in isolation

### Negative

- Eventual consistency (async)
- Debugging event chains
- Potential event storms

## Decision Outcome

The event bus pattern is well-established for this type of integration. tokio broadcast provides the right semantics (multiple receivers, async).

## More Information

- **Date:** 2025-12-28
- **Source:** SPEC-2025-12-28: Subcog Rust Rewrite
