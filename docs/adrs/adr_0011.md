---
title: "Hybrid Detection Strategy (Keyword + LLM)"
description: "Combines fast keyword pattern matching with optional LLM classification for search intent detection with graceful fallback."
type: adr
category: search
tags:
  - search-intent
  - hybrid-detection
  - keyword-matching
  - llm-classification
  - graceful-degradation
status: published
created: 2025-12-30
updated: 2026-01-04
author: Claude (Architect)
project: subcog
technologies:
  - llm
audience:
  - developers
  - architects
confidence: high
completeness: complete
---

# ADR-0011: Hybrid Detection Strategy (Keyword + LLM)

## Status

Accepted

## Context

We need to detect search intent in user prompts to trigger proactive memory surfacing. Two approaches are available:

1. Keyword-based pattern matching (fast, deterministic, limited accuracy)
2. LLM-based classification (slower, more accurate, requires LLM provider)

## Decision

We will implement a **hybrid detection strategy** that combines both approaches:

- Run keyword detection first (always, <10ms)
- Optionally run LLM classification in parallel when configured
- Merge results: use LLM topics when available, keyword confidence as baseline
- Fall back to keyword-only when LLM unavailable or times out

## Consequences

### Positive

- Best of both worlds: fast baseline + optional accuracy boost
- Graceful degradation when LLM unavailable
- Keyword detection provides consistent, predictable behavior
- LLM classification improves topic extraction significantly

### Negative

- More complex implementation than either approach alone
- Two code paths to test and maintain
- Potential for confusion about which detection source was used

### Neutral

- Users can disable LLM classification via configuration
- Detection source tracked in SearchIntent for debugging

## More Information

- **Date:** 2025-12-30
- **Source:** SPEC-2025-12-30-001: Proactive Memory Surfacing
