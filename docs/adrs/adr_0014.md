---
title: "200ms LLM Timeout"
description: "Use 200ms timeout for LLM classification with automatic fallback to keyword detection to balance accuracy and responsiveness."
type: adr
category: performance
tags:
  - timeout
  - llm
  - latency
  - graceful-degradation
  - configuration
status: published
created: 2025-12-30
updated: 2026-01-04
author: Claude (Architect)
project: subcog
technologies:
  - llm
audience:
  - developers
  - architects
confidence: high
completeness: complete
---

# ADR-0014: 200ms LLM Timeout

## Status

Accepted

## Context

LLM classification can vary widely in latency (50ms to 2s+). We need a timeout that balances accuracy (waiting for LLM) vs responsiveness (not blocking the hook).

## Decision

We will use a **200ms timeout** for LLM classification with automatic fallback to keyword detection:

- 200ms chosen based on P95 LLM latency for classification tasks
- Timeout triggers keyword-only path, not an error
- Timeout events are logged for monitoring

## Consequences

### Positive

- Guarantees <200ms LLM contribution to total latency
- Graceful fallback to working (keyword) detection
- Predictable worst-case response time

### Negative

- May miss LLM classification in ~10% of cases (slow responses)
- Short timeout may waste LLM API calls

### Neutral

- Timeout configurable via `llm_timeout_ms`

## Options Considered

### Option 1: 500ms timeout

**Pros:**
- More LLM results

**Cons:**
- Total hook latency would exceed 200ms target

### Option 2: No timeout, async

Return immediately, inject LLM results on next message

**Cons:**
- Complex state management, confusing UX

## More Information

- **Date:** 2025-12-30
- **Source:** SPEC-2025-12-30-001: Proactive Memory Surfacing
