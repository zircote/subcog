---
title: "Empty String Return for Notification Responses"
description: "Return empty string from process_request() for notifications to signal no response should be sent."
type: adr
category: integration
tags:
  - json-rpc
  - mcp
  - notification
  - response-handling
status: published
created: 2026-01-04
updated: 2026-01-04
author: Claude (Architect)
project: subcog
audience:
  - developers
  - architects
confidence: high
completeness: complete
---

# ADR-0055: Empty String Return for Notification Responses

## Status

Accepted

## Context

When a notification is received, we need to signal to the caller that no response should be sent. We need a mechanism that works with the existing code structure.

## Decision Drivers

### Primary Decision Drivers

1. **Minimal Change**: Should not require large refactors
2. **Clear Semantics**: Signal should be unambiguous
3. **Compatibility**: Must work with existing return type

### Secondary Decision Drivers

1. **Simplicity**: Avoid over-engineering
2. **Efficiency**: No unnecessary allocations

## Considered Options

### Option 1: Empty String Return (Selected)

**Description**: Return `String::new()` from `process_request()` for notifications. Caller checks `if !response.is_empty()` before writing.

**Advantages**:
- Minimal code change
- Clear semantics (empty = nothing to send)
- No changes to return type signature

**Disadvantages**:
- Caller must remember to check for empty string
- Empty string could theoretically be a valid response (but isn't in JSON-RPC)

### Option 2: Return `Option<String>`

**Description**: Change return type to `Option<String>`, return `None` for notifications.

**Advantages**:
- Cleaner semantically
- Type system enforces handling

**Disadvantages**:
- Requires changing all callers and the function signature
- Larger refactor

### Option 3: Throw/Return Error

**Description**: Return an error for notifications.

**Advantages**:
- None

**Disadvantages**:
- Incorrect - notifications are valid messages, not errors
- Would pollute error logs

### Option 4: Set Flag on Server

**Description**: Set a flag indicating no response needed.

**Advantages**:
- Explicit signal

**Disadvantages**:
- Stateful and error-prone
- Requires additional state management

## Decision

We will return an empty string (`String::new()`) from `process_request()` for notifications. The caller checks `if !response.is_empty()` before writing to stdout.

## Consequences

### Positive

- Minimal code change
- Clear semantics (empty = nothing to send)
- No changes to return type signature

### Negative

- Caller must remember to check for empty string
- Empty string could theoretically be a valid response (but isn't in JSON-RPC)

### Neutral

- Alternative would be `Option<String>` return type, but that's a larger refactor

## More Information

- **Date:** 2026-01-04
- **Source:** SPEC-2026-01-04-001: MCP Server JSON-RPC Notification Compliance
- **GitHub Issue:** [#46](https://github.com/zircote/subcog/issues/46)

## Audit

### 2026-01-04

**Status:** Compliant

**Findings:**

| Finding | Files | Lines | Assessment |
|---------|-------|-------|------------|
| handle_request returns empty string for notifications | `src/mcp/server.rs` | L623-L692 | compliant |

**Summary:** Stdio notifications return an empty response string.

**Action Required:** None
