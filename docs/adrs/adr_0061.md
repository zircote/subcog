---
title: "MCP Tool Consolidation"
description: "Consolidate 43 MCP tools into ~25 by using action-based patterns, reducing LLM context overhead and improving API consistency."
type: adr
category: api
tags:
  - mcp
  - tools
  - api-design
  - consolidation
  - breaking-change
status: proposed
created: 2026-01-14
updated: 2026-01-14
author: Claude (Architect)
project: subcog
technologies:
  - mcp
  - json-schema
  - rust
audience:
  - developers
  - integrators
confidence: high
completeness: complete
---

# ADR-0061: MCP Tool Consolidation

## Status

Proposed

## Context

Subcog's MCP tool surface has grown to 43 tools, creating several problems:

### Current Tool Inventory (43 tools)

| Category | Tools | Count |
|----------|-------|-------|
| Core Memory CRUD | capture, recall, get, delete, update, list, delete_all, restore | 8 |
| Status/Meta | status, prompt_understanding, namespaces, init, history | 5 |
| Maintenance | consolidate, get_summary, enrich, reindex, sync, gdpr_export | 6 |
| Prompt Templates | prompt_save, prompt_list, prompt_get, prompt_run, prompt_delete | 5 |
| Context Templates | context_template_save/list/get/render/delete | 5 |
| Knowledge Graph | entities, relationships, graph_query, extract_entities, entity_merge, relationship_infer, graph_visualize | 7 |
| Group Management | group_create/list/get/add_member/remove_member/update_role/delete | 7 |

### Problems

1. **LLM Context Overhead**: 43 tool schemas consume significant context tokens at session start
2. **Inconsistent Patterns**: Some tools use `action` parameter (entities, relationships), others use separate tools (prompt_*, group_*)
3. **Discovery Overwhelm**: Users and LLMs struggle to find the right tool
4. **Maintenance Burden**: Each tool requires separate handler, tests, and documentation
5. **MCP Best Practice Violation**: The MCP specification recommends grouping related operations

### Industry Comparison

| MCP Server | Tool Count | Pattern |
|------------|------------|---------|
| Mem0 | ~5 | add, search, get, update, delete |
| filesystem | ~10 | Grouped by operation type |
| GitHub | ~15 | Grouped by resource |
| **Subcog** | **43** | Sprawling, inconsistent |

## Decision

Consolidate tools using the action-based pattern already established in `subcog_entities` and `subcog_relationships`. This reduces the tool count from 43 to ~25 while maintaining full functionality.

### Consolidation Plan

#### Phase 1: Template Consolidation (10 → 2 tools)

**Before:**
```
prompt_save, prompt_list, prompt_get, prompt_run, prompt_delete
context_template_save, context_template_list, context_template_get, context_template_render, context_template_delete
```

**After:**
```json
// subcog_prompt (action: save|list|get|run|delete)
{
  "action": "save",
  "name": "code-review",
  "content": "Review this code for..."
}

// subcog_template (action: save|list|get|render|delete)
{
  "action": "render",
  "name": "session-context",
  "variables": { "topic": "authentication" }
}
```

#### Phase 2: Group Consolidation (7 → 1 tool)

**Before:**
```
subcog_group_create, subcog_group_list, subcog_group_get,
subcog_group_add_member, subcog_group_remove_member,
subcog_group_update_role, subcog_group_delete
```

**After:**
```json
// subcog_group (action: create|list|get|add_member|remove_member|update_role|delete)
{
  "action": "add_member",
  "group_id": "abc123",
  "user_id": "bob@example.com",
  "role": "write"
}
```

#### Phase 3: Graph Consolidation (7 → 3 tools)

**Before:**
```
subcog_entities, subcog_relationships, subcog_graph_query,
subcog_extract_entities, subcog_entity_merge,
subcog_relationship_infer, subcog_graph_visualize
```

**After:**
```
subcog_entities (existing, add: extract, merge actions)
subcog_relationships (existing, add: infer action)
subcog_graph (merge: query, visualize → operation parameter)
```

#### Phase 4: Core CRUD Optimization (8 → 6 tools)

- Merge `subcog_list` into `subcog_recall` with `query: null` for unfiltered listing
- Keep `subcog_delete_all` separate (dangerous operation, explicit naming)
- Keep `subcog_restore` separate (recovery operation)

### Resulting Tool Count

| Category | Before | After | Reduction |
|----------|--------|-------|-----------|
| Core Memory | 8 | 6 | -2 |
| Status/Meta | 5 | 5 | 0 |
| Maintenance | 6 | 5 | -1 (remove sync) |
| Prompt Templates | 5 | 1 | -4 |
| Context Templates | 5 | 1 | -4 |
| Knowledge Graph | 7 | 3 | -4 |
| Group Management | 7 | 1 | -6 |
| **Total** | **43** | **22** | **-21 (49%)** |

## Consequences

### Positive

- **49% reduction** in tool count (43 → 22)
- **Consistent API patterns** across all tool categories
- **Reduced context overhead** for LLM tool discovery
- **Easier maintenance** with fewer handlers and tests
- **Better alignment** with MCP best practices
- **Improved discoverability** with logical groupings

### Negative

- **Breaking change** for existing integrations
- **Migration effort** for users with saved prompts/scripts
- **Slightly more complex** individual tool schemas (action enum)
- **Documentation rewrite** required

### Mitigation

1. **Deprecation period**: Keep old tools as aliases for 2 minor versions
2. **Migration guide**: Document mapping from old to new tools
3. **Compatibility layer**: Old tool names route to new consolidated handlers

## Alternatives Considered

### Alternative 1: Keep Current Structure
- **Rejected**: Unsustainable growth pattern, already at 43 tools

### Alternative 2: Namespace-Based Tools (subcog.memory.capture)
- **Rejected**: MCP doesn't support hierarchical tool names; would require custom routing

### Alternative 3: Single Mega-Tool
- **Rejected**: Too complex, poor discoverability, violates single-responsibility

## Implementation

See: `docs/architecture/MCP-CONSOLIDATION-PLAN.md`

## More Information

- **Date:** 2026-01-14
- **Related ADRs:** ADR-0047 (MCP Server Architecture)
- **MCP Specification:** https://modelcontextprotocol.io/specification
