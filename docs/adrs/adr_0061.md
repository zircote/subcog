---
title: "MCP Tool Consolidation"
description: "Consolidate 43 MCP tools into ~25 by using action-based patterns, reducing LLM context overhead and improving API consistency."
type: adr
category: api
tags:
  - mcp
  - tools
  - api-design
  - consolidation
  - breaking-change
status: proposed
created: 2026-01-14
updated: 2026-01-14
author: Claude (Architect)
project: subcog
technologies:
  - mcp
  - json-schema
  - rust
audience:
  - developers
  - integrators
confidence: high
completeness: complete
---

# ADR-0061: MCP Tool Consolidation

## Status

Proposed

## Context

Subcog's MCP tool surface has grown to 43 tools, creating several problems:

### Current Tool Inventory (43 tools)

| Category | Tools | Count |
|----------|-------|-------|
| Core Memory CRUD | capture, recall, get, delete, update, list, delete_all, restore | 8 |
| Status/Meta | status, prompt_understanding, namespaces, init, history | 5 |
| Maintenance | consolidate, get_summary, enrich, reindex, sync, gdpr_export | 6 |
| Prompt Templates | prompt_save, prompt_list, prompt_get, prompt_run, prompt_delete | 5 |
| Context Templates | context_template_save/list/get/render/delete | 5 |
| Knowledge Graph | entities, relationships, graph_query, extract_entities, entity_merge, relationship_infer, graph_visualize | 7 |
| Group Management | group_create/list/get/add_member/remove_member/update_role/delete | 7 |

### Problems

1. **LLM Context Overhead**: 43 tool schemas consume significant context tokens at session start
2. **Inconsistent Patterns**: Some tools use `action` parameter (entities, relationships), others use separate tools (prompt_*, group_*)
3. **Discovery Overwhelm**: Users and LLMs struggle to find the right tool
4. **Maintenance Burden**: Each tool requires separate handler, tests, and documentation
5. **MCP Best Practice Violation**: The MCP specification recommends grouping related operations

### Industry Comparison

| MCP Server | Tool Count | Pattern |
|------------|------------|---------|
| Mem0 | ~5 | add, search, get, update, delete |
| filesystem | ~10 | Grouped by operation type |
| GitHub | ~15 | Grouped by resource |
| **Subcog** | **43** | Sprawling, inconsistent |

## Decision Drivers

### Primary Decision Drivers

1. **LLM Context Efficiency**: Fewer tools means fewer tokens consumed for tool discovery
2. **API Consistency**: Uniform patterns across all tool categories reduce learning curve
3. **Discoverability**: Logical groupings make it easier for LLMs and humans to find operations
4. **MCP Compliance**: Following MCP best practices improves interoperability

### Secondary Decision Drivers

1. **Maintenance Reduction**: Fewer handlers and tests to maintain
2. **Documentation Simplification**: Easier to document consolidated APIs
3. **Backward Compatibility**: Migration path for existing integrations

## Considered Options

### Option 1: Keep Current Structure

**Description**: Maintain all 43 tools as-is.

**Advantages**:
- No breaking changes
- No migration effort

**Disadvantages**:
- Unsustainable growth pattern
- Already at 43 tools
- Inconsistent API surface
- Poor LLM context efficiency

**Why Not Selected**: Unsustainable growth pattern, already at 43 tools.

### Option 2: Namespace-Based Tools (subcog.memory.capture)

**Description**: Use hierarchical tool names like `subcog.memory.capture`.

**Advantages**:
- Clear organization
- Familiar pattern from other APIs

**Disadvantages**:
- MCP doesn't support hierarchical tool names
- Would require custom routing layer
- Non-standard approach

**Why Not Selected**: MCP doesn't support hierarchical tool names; would require custom routing.

### Option 3: Single Mega-Tool

**Description**: One `subcog` tool with complex parameter routing.

**Advantages**:
- Minimal tool count (1)

**Disadvantages**:
- Too complex
- Poor discoverability
- Violates single-responsibility
- Difficult to document

**Why Not Selected**: Too complex, poor discoverability, violates single-responsibility.

### Option 4: Action-Based Consolidation (Selected)

**Description**: Consolidate related operations into single tools using `action` parameter.

**Advantages**:
- 49% reduction in tool count (43 to 22)
- Consistent API patterns
- Better discoverability
- Follows pattern already used by entities/relationships tools
- Aligns with MCP best practices

**Disadvantages**:
- Breaking change for existing integrations
- Migration effort required
- Slightly more complex individual tool schemas

## Decision

Consolidate tools using the action-based pattern already established in `subcog_entities` and `subcog_relationships`. This reduces the tool count from 43 to ~25 while maintaining full functionality.

### Consolidation Plan

#### Phase 1: Template Consolidation (10 to 2 tools)

**Before:**
```
prompt_save, prompt_list, prompt_get, prompt_run, prompt_delete
context_template_save, context_template_list, context_template_get, context_template_render, context_template_delete
```

**After:**
```json
// subcog_prompt (action: save|list|get|run|delete)
{
  "action": "save",
  "name": "code-review",
  "content": "Review this code for..."
}

// subcog_template (action: save|list|get|render|delete)
{
  "action": "render",
  "name": "session-context",
  "variables": { "topic": "authentication" }
}
```

#### Phase 2: Group Consolidation (7 to 1 tool)

**Before:**
```
subcog_group_create, subcog_group_list, subcog_group_get,
subcog_group_add_member, subcog_group_remove_member,
subcog_group_update_role, subcog_group_delete
```

**After:**
```json
// subcog_group (action: create|list|get|add_member|remove_member|update_role|delete)
{
  "action": "add_member",
  "group_id": "abc123",
  "user_id": "bob@example.com",
  "role": "write"
}
```

#### Phase 3: Graph Consolidation (7 to 3 tools)

**Before:**
```
subcog_entities, subcog_relationships, subcog_graph_query,
subcog_extract_entities, subcog_entity_merge,
subcog_relationship_infer, subcog_graph_visualize
```

**After:**
```
subcog_entities (existing, add: extract, merge actions)
subcog_relationships (existing, add: infer action)
subcog_graph (merge: query, visualize -> operation parameter)
```

#### Phase 4: Core CRUD Optimization (8 to 6 tools)

- Merge `subcog_list` into `subcog_recall` with `query: null` for unfiltered listing
- Keep `subcog_delete_all` separate (dangerous operation, explicit naming)
- Keep `subcog_restore` separate (recovery operation)

### Resulting Tool Count

| Category | Before | After | Reduction |
|----------|--------|-------|-----------|
| Core Memory | 8 | 6 | -2 |
| Status/Meta | 5 | 5 | 0 |
| Maintenance | 6 | 5 | -1 (remove sync) |
| Prompt Templates | 5 | 1 | -4 |
| Context Templates | 5 | 1 | -4 |
| Knowledge Graph | 7 | 3 | -4 |
| Group Management | 7 | 1 | -6 |
| **Total** | **43** | **22** | **-21 (49%)** |

## Consequences

### Positive

- **49% reduction** in tool count (43 to 22)
- **Consistent API patterns** across all tool categories
- **Reduced context overhead** for LLM tool discovery
- **Easier maintenance** with fewer handlers and tests
- **Better alignment** with MCP best practices
- **Improved discoverability** with logical groupings

### Negative

- **Breaking change** for existing integrations
- **Migration effort** for users with saved prompts/scripts
- **Slightly more complex** individual tool schemas (action enum)
- **Documentation rewrite** required

### Neutral

- Mitigation strategies available: Deprecation period (keep old tools as aliases for 2 minor versions); migration guide documenting mapping from old to new tools; compatibility layer routing old tool names to new consolidated handlers

## More Information

- **Date:** 2026-01-14
- **Related ADRs:** ADR-0047 (MCP Server Architecture)
- **MCP Specification:** https://modelcontextprotocol.io/specification
- **Implementation Plan:** `docs/architecture/MCP-CONSOLIDATION-PLAN.md`

## Audit

### 2026-01-15

**Status:** Pending

**Findings:** Initial audit pending.

**Summary:** ADR migrated to structured-madr format.

**Action Required:** Complete audit after implementation review.
